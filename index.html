<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no" />
  <title>DTR Manager - OJT Calculator</title>
  <!-- Google Fonts: Inter and Outfit -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@300;400;600;700&display=swap"
    rel="stylesheet">
</head>

<body>
  <!-- Toast Notifications (Moved to top) -->
  <div id="toast-container" class="toast-container-top"></div>

  <!-- Splash Screen -->
  <div id="splash-screen" class="splash-screen">
    <div class="splash-content">
      <div class="splash-logo">DTR</div>
      <h1 class="splash-text">OJT Manager <br> <span>by Cris John</span></h1>
      <div class="loader-bar">
        <div class="loader-progress"></div>
      </div>
    </div>
  </div>

  <!-- Auth Screen (Native Look) -->
  <div id="auth-container" class="auth-screen hidden">
    <div class="auth-wrapper">
      <div class="auth-header-native">
        <h1 class="logo-text">DTR</h1>
        <p id="auth-subtitle" class="subtitle-text">Sign in to continue</p>
      </div>

      <!-- Login View -->
      <form id="login-form" class="native-form">
        <div class="native-group">
          <input type="email" id="login-email" placeholder="Email Address" required>
          <span class="error-line"></span>
        </div>
        <div class="native-group">
          <input type="password" id="login-password" placeholder="Password" required>
          <span class="error-line"></span>
        </div>
        <button type="submit" class="native-primary-btn">Sign In</button>
        <div class="native-divider"><span>OR</span></div>
        <button type="button" id="google-login-btn" class="native-google-btn">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/action/google.svg" width="20" height="20" alt="">
          Continue with Google
        </button>
        <p class="native-footer">New here? <a href="#" id="to-signup">Create Account</a></p>
      </form>

      <!-- Signup View -->
      <form id="signup-form" class="native-form hidden">
        <div class="native-group">
          <input type="text" id="signup-name" placeholder="Full Name" required>
          <span class="error-line"></span>
        </div>
        <div class="native-group">
          <input type="email" id="signup-email" placeholder="Email Address" required>
          <span class="error-line"></span>
        </div>
        <div class="native-group">
          <input type="password" id="signup-password" placeholder="Create Password" required>
          <span class="error-line"></span>
        </div>
        <div class="native-group">
          <div class="native-role-selector">
            <label class="native-role-opt">
              <input type="radio" name="role" value="student" checked>
              <span>Student</span>
            </label>
            <label class="native-role-opt">
              <input type="radio" name="role" value="teacher">
              <span>Teacher</span>
            </label>
          </div>
        </div>
        <div id="class-code-group" class="native-group">
          <input type="text" id="signup-class-code" placeholder="Class Code (Optional)">
          <span class="error-line"></span>
        </div>
        <button type="submit" class="native-primary-btn">Create Account</button>
        <p class="native-footer">Already have an account? <a href="#" id="to-login">Sign In</a></p>
      </form>
    </div>
  </div>

  <!-- Google Setup -->
  <div id="google-setup-modal" class="modal-overlay hidden">
    <div class="modal-native">
      <h3>Complete Profile</h3>
      <p>Select your account type to finish setup.</p>
      <div class="native-role-selector" style="margin: 1.5rem 0;">
        <label class="native-role-opt">
          <input type="radio" name="setup-role" value="student" checked>
          <span>Student</span>
        </label>
        <label class="native-role-opt">
          <input type="radio" name="setup-role" value="teacher">
          <span>Teacher</span>
        </label>
      </div>
      <div class="native-group">
        <input type="text" id="setup-class-code" placeholder="Class Code (Optional)">
      </div>
      <button type="button" id="save-setup-btn" class="native-primary-btn">Finish Setup</button>
    </div>
  </div>

  <!-- Main App Content -->
  <div id="root" class="app-shell hidden">
    <!-- Top Toolbar -->
    <header class="top-toolbar">
      <div class="toolbar-content">
        <div class="toolbar-left">
          <h1 class="toolbar-logo">DTR</h1>
        </div>
        <div class="toolbar-center">
          <span id="view-title" class="view-title">Dashboard</span>
        </div>
        <div class="toolbar-right">
          <div id="sync-indicator" class="sync-dot"></div>
          <span id="user-role-badge" class="role-chip">Student</span>
        </div>
      </div>
    </header>

    <!-- Main View Container -->
    <main id="main-content" class="view-container">

      <!-- Home View (Dashboard) -->
      <section id="view-home" class="app-view">
        <div class="welcome-banner">
          <span class="greeting-text">Hello, <span id="user-display-name">---</span></span>
          <p class="date-display" id="current-date">Fetching date...</p>
        </div>

        <div class="main-stats-card">
          <div class="progress-ring-box">
            <svg class="progress-ring" viewBox="0 0 100 100">
              <circle class="ring-bg" cx="50" cy="50" r="45"></circle>
              <circle id="progress-bar" class="ring-fill" cx="50" cy="50" r="45"></circle>
            </svg>
            <div class="ring-inner">
              <span id="rendered-hours" class="hours-val">0h</span>
              <span id="rendered-percent" class="percent-val">0%</span>
              <small>Complete</small>
            </div>
          </div>
          <div class="stats-row">
            <div class="stat-box">
              <span class="stat-lbl">Goal</span>
              <span id="goal-hours-display" class="stat-num">---</span>
            </div>
            <div class="stat-box">
              <span class="stat-lbl">Remaining</span>
              <span id="remaining-hours" class="stat-num">---</span>
            </div>
          </div>
        </div>

        <!-- Dynamic Chronometer -->
        <div id="active-session-card" class="session-card-native hidden">
          <div class="session-header-mini">
            <span class="pulse-dot"></span>
            ACTIVE SESSION
          </div>
          <h2 id="session-timer" class="chrono-text">00:00:00</h2>
        </div>

        <div class="dashboard-actions">
          <div id="stopped-actions" class="action-row">
            <button type="button" id="time-in-btn" class="main-fab in">
              <i data-lucide="play"></i>
              <span>TIME IN</span>
            </button>
          </div>
          <div id="started-actions" class="action-row hidden">
            <button type="button" id="time-out-btn" class="main-fab out">
              <i data-lucide="square"></i>
              <span>STOP</span>
            </button>
            <button type="button" id="pause-btn" class="main-fab pause">
              <i data-lucide="pause"></i>
              <span>PAUSE</span>
            </button>
          </div>
        </div>

        <div class="insight-grid">
          <div class="insight-card">
            <span class="insight-lbl">Avg Session</span>
            <span id="avg-session" class="insight-val">0h</span>
          </div>
          <div class="insight-card">
            <span class="insight-lbl">Last 7 Days</span>
            <span id="week-total" class="insight-val">0h</span>
          </div>
        </div>
      </section>

      <!-- Journal View -->
      <section id="view-journal" class="app-view hidden">
        <div class="view-header-inline">
          <h2>Journal & Logs</h2>
          <div class="header-actions-inline">
            <button id="download-journal-btn" class="icon-text-btn">
              <i data-lucide="file-spreadsheet"></i>
              <span>Export</span>
            </button>
            <button id="manual-entry-btn" class="icon-text-btn primary">
              <i data-lucide="plus"></i>
              <span>Add Past</span>
            </button>
          </div>
        </div>

        <!-- Manual Entry Inline Form (Instead of Modal) -->
        <div id="manual-form-container" class="inline-card hidden">
          <div class="card-header">
            <h3>Add Past Hours</h3>
            <button id="close-manual" class="close-card-btn"><i data-lucide="x"></i></button>
          </div>
          <div class="inline-form">
            <div class="native-group">
              <label>Date</label>
              <input type="date" id="manual-date" required>
            </div>
            <div class="form-row">
              <div class="native-group">
                <label>Start Time</label>
                <input type="time" id="manual-time-in" required>
              </div>
              <div class="native-group">
                <label>End Time</label>
                <input type="time" id="manual-time-out" required>
              </div>
            </div>
            <div class="native-group">
              <label>Activities Conducted</label>
              <textarea id="manual-notes" placeholder="What did you do?"></textarea>
            </div>
            <button id="save-manual-btn" class="native-primary-btn">Save Entry</button>
          </div>
        </div>

        <div id="logs-list" class="native-logs-list">
          <!-- Logs injected here -->
        </div>
        <button id="view-all-btn" class="full-width-btn">View More History</button>
      </section>

      <!-- Full History View -->
      <section id="view-history" class="app-view hidden">
        <div class="view-header-inline">
          <button id="close-history" class="back-btn"><i data-lucide="arrow-left"></i></button>
          <h2>History</h2>
        </div>
        <div id="history-logs-list" class="native-logs-list"></div>
      </section>

      <!-- Archive View (Trash) -->
      <section id="view-archive" class="app-view hidden">
        <div class="view-header-inline">
          <button id="close-archive" class="back-btn"><i data-lucide="arrow-left"></i></button>
          <h2>Archive</h2>
        </div>
        <p class="archive-note">Logs here will be permanently deleted after 30 days.</p>
        <div id="archive-logs-list" class="native-logs-list"></div>
      </section>

      <!-- Settings View -->
      <section id="view-settings" class="app-view hidden">
        <div class="settings-group">
          <h3>OJT Goal</h3>
          <div class="inline-card">
            <div class="native-group">
              <label>Total Required Hours</label>
              <input type="number" id="goal-hours-input" value="600">
            </div>
            <button id="save-settings" class="native-primary-btn">Update Goal</button>
          </div>
        </div>

        <div id="student-class-settings" class="settings-group hidden">
          <h3>Class Membership</h3>
          <div class="inline-card">
            <div id="no-class-view">
              <div class="native-group">
                <input type="text" id="join-class-input" placeholder="Enter Class Code">
              </div>
              <button id="join-class-btn" class="native-primary-btn">Join Class</button>
            </div>
            <div id="has-class-view" class="class-joined-box hidden">
              <div class="joined-info">
                <span>Joined: <strong id="current-class-display">---</strong></span>
              </div>
              <button id="leave-class-btn" class="native-danger-btn-outline">Leave Class</button>
            </div>
          </div>
        </div>

        <div class="settings-group">
          <h3>Preferences</h3>
          <div class="setting-item-toggle">
            <div class="toggle-info">
              <span>Dark Mode</span>
              <small>Toggle app appearance</small>
            </div>
            <button id="theme-toggle" class="toggle-btn-native">
              <i data-lucide="moon"></i>
            </button>
          </div>
        </div>

        <div class="settings-group">
          <h3>Data & Security</h3>
          <div class="inline-card">
            <button id="view-archive-btn" class="native-secondary-btn"
              style="margin-bottom:12px; border-color: var(--warning); color: var(--warning);">
              <i data-lucide="trash-2" style="width:16px; margin-right:8px;"></i>
              Open Archive (Recycle Bin)
            </button>
            <button id="clear-data" class="native-danger-btn">Delete All App Data</button>
          </div>
        </div>

        <div class="settings-group logout-v">
          <button id="logout-btn" class="native-primary-btn danger">Sign Out</button>
        </div>
      </section>

      <!-- Teacher View -->
      <section id="teacher-section" class="app-view teacher-view hidden">
        <div class="teacher-header-native">
          <div id="class-selector" class="h-pills">
            <!-- Class pills injected -->
          </div>
          <div class="class-info-card">
            <div class="code-box">
              <small>CLASS CODE</small>
              <h2 id="display-class-code">---</h2>
            </div>
            <button id="copy-code-btn" class="circle-btn"><i data-lucide="copy"></i></button>
          </div>
        </div>

        <div class="teacher-analytics-row">
          <div class="analytic-tile">
            <small>Student Avg</small>
            <h4 id="class-avg">0h</h4>
          </div>
          <div class="analytic-tile">
            <small>Completion</small>
            <h4 id="top-pct">0%</h4>
          </div>
        </div>

        <div class="teacher-actions-bar">
          <div class="native-search">
            <i data-lucide="search"></i>
            <input type="text" id="student-search" placeholder="Search students...">
          </div>
          <button id="export-class-btn" class="icon-btn-native"><i data-lucide="file-spreadsheet"></i></button>
          <button id="refresh-teacher-btn" class="icon-btn-native"><i data-lucide="refresh-cw"></i></button>
        </div>

        <div id="students-list" class="native-students-list">
          <!-- Student cards injected -->
        </div>
      </section>

      <!-- Student Detail View (Teacher Side) -->
      <section id="student-detail-view" class="app-view hidden">
        <div class="view-header-inline">
          <button id="close-student-modal" class="back-btn"><i data-lucide="arrow-left"></i></button>
          <h2 id="modal-student-name">Student Detail</h2>
        </div>
        <div class="student-overview-card">
          <div class="o-stat">
            <small>Total Rendered</small>
            <span id="modal-student-rendered">0h</span>
          </div>
          <div class="o-stat">
            <small>Current Goal</small>
            <span id="modal-student-goal">600h</span>
          </div>
        </div>
        <div id="modal-student-logs" class="native-logs-list"></div>
        <button id="kick-student-btn" class="native-danger-btn" style="margin-top: 2rem;">Remove Student from
          Class</button>
      </section>

    </main>

    <!-- Bottom Navigation Tabs -->
    <nav class="bottom-nav">
      <button class="nav-tab active" data-view="home">
        <i data-lucide="layout-dashboard"></i>
        <span>Dashboard</span>
      </button>
      <button class="nav-tab" data-view="journal">
        <i data-lucide="book-open"></i>
        <span>Journal</span>
      </button>
      <button class="nav-tab" data-view="settings">
        <i data-lucide="settings"></i>
        <span>Settings</span>
      </button>
    </nav>
  </div>

  <!-- Time Out Session Activities (Full Screen) -->
  <div id="timeout-modal" class="modal-overlay hidden">
    <div class="modal-native">
      <h3>Session Finished</h3>
      <p>Describe your tasks today for the audit journal.</p>
      <div class="native-group" style="margin: 1.5rem 0;">
        <textarea id="log-notes-input" placeholder="e.g. Encoded employee records, attended meeting..."
          rows="5"></textarea>
      </div>
      <button type="button" id="confirm-timeout-btn" class="native-primary-btn">Finish & Sign Log</button>
      <button type="button" id="close-timeout" class="native-secondary-btn-flat">Back</button>
    </div>
  </div>

  <!-- Create Class Screen (Teacher) -->
  <div id="create-class-modal" class="modal-overlay hidden">
    <div class="modal-native">
      <h3>Create New Class</h3>
      <div class="native-group" style="margin: 1.5rem 0;">
        <input type="text" id="new-class-name" placeholder="e.g. BSCS 4-B">
      </div>
      <button id="confirm-create-class" class="native-primary-btn">Create Class</button>
      <button id="close-create-class" class="native-secondary-btn-flat">Cancel</button>
    </div>
  </div>

  <!-- Confirmation Screen -->
  <div id="confirm-modal" class="modal-overlay hidden">
    <div class="modal-native">
      <h3 id="confirm-title">Confirm Action</h3>
      <p id="confirm-description">Are you sure you want to proceed?</p>
      <div class="modal-actions-native">
        <button id="confirm-cancel-btn" class="native-secondary-btn-flat">Cancel</button>
        <button id="confirm-action-btn" class="native-danger-btn">Confirm</button>
      </div>
    </div>
  </div>

  <div class="version-tag">v9.1.0 (Archive & UI Fix)</div>

  <script type="module" src="src/main.js"></script>
</body>

</html>