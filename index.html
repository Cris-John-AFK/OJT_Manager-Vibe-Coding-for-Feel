<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no" />
  <title>DTR Manager - OJT Calculator</title>
  <!-- Google Fonts: Inter and Outfit -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@300;400;600;700&display=swap"
    rel="stylesheet">
</head>

<body>
  <!-- Splash Screen -->
  <div id="splash-screen" class="splash-screen">
    <div class="splash-content">
      <div class="splash-logo">DTR</div>
      <h1 class="splash-text">Welcome to DTR manager <br> <span>by Cris John</span></h1>
      <h1 class="splash-text">Powered by<br> <span>Antigravity</span></h1>
      <div class="loader-bar">
        <div class="loader-progress"></div>
      </div>
    </div>
  </div>

  <!-- Auth Container -->
  <div id="auth-container" class="auth-container hidden">
    <div class="auth-card">
      <div class="auth-header">
        <h1 class="auth-logo">DTR</h1>
        <p id="auth-subtitle">Login to your account</p>
      </div>

      <!-- Login Form -->
      <form id="login-form" class="auth-form">
        <div class="form-group">
          <label for="login-email">Email</label>
          <input type="email" id="login-email" placeholder="email@example.com" required>
        </div>
        <div class="form-group">
          <label for="login-password">Password</label>
          <input type="password" id="login-password" placeholder="••••••••" required>
        </div>
        <button type="submit" class="primary-btn">Login</button>
        <div class="divider"><span>OR</span></div>
        <button type="button" id="google-login-btn" class="secondary-btn">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/action/google.svg" width="18" height="18" alt="">
          Login with Google
        </button>
        <p class="auth-footer">Don't have an account? <a href="#" id="to-signup">Sign Up</a></p>
      </form>

      <!-- Signup Form -->
      <form id="signup-form" class="auth-form hidden">
        <div class="form-group">
          <label for="signup-name">Full Name</label>
          <input type="text" id="signup-name" placeholder="John Doe" required>
        </div>
        <div class="form-group">
          <label for="signup-email">Email Address</label>
          <input type="email" id="signup-email" placeholder="email@example.com" required>
        </div>
        <div class="form-group">
          <label for="signup-password">Password</label>
          <input type="password" id="signup-password" placeholder="••••••••" required>
        </div>
        <div class="form-group">
          <label>Account Type</label>
          <div class="role-selector">
            <label class="role-opt">
              <input type="radio" name="role" value="student" checked>
              <span>Student</span>
            </label>
            <label class="role-opt">
              <input type="radio" name="role" value="teacher">
              <span>Teacher</span>
            </label>
          </div>
        </div>
        <div id="class-code-group" class="form-group">
          <label for="signup-class-code">Class Code (Optional)</label>
          <input type="text" id="signup-class-code" placeholder="Enter teacher's code">
        </div>
        <button type="submit" class="primary-btn">Create Account</button>
        <div class="divider"><span>OR</span></div>
        <button type="button" id="google-signup-btn" class="secondary-btn">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/action/google.svg" width="18" height="18" alt="">
          Sign up with Google
        </button>
        <p class="auth-footer">Already have an account? <a href="#" id="to-login">Login</a></p>
      </form>
    </div>
  </div>

  <!-- Google Role Completion Modal -->
  <div id="google-setup-modal" class="modal hidden">
    <div class="modal-content">
      <header class="modal-header">
        <h2>Complete Profile</h2>
      </header>
      <div class="modal-body">
        <p class="modal-description">Please select your account type to continue.</p>
        <div class="form-group" style="margin-top: 1rem;">
          <label>Account Type</label>
          <div class="role-selector">
            <label class="role-opt">
              <input type="radio" name="setup-role" value="student" checked>
              <span>Student</span>
            </label>
            <label class="role-opt">
              <input type="radio" name="setup-role" value="teacher">
              <span>Teacher</span>
            </label>
          </div>
        </div>
        <div class="form-group">
          <label for="setup-class-code">Class Code (Optional)</label>
          <input type="text" id="setup-class-code" placeholder="Enter teacher's code">
        </div>
        <button type="button" id="save-setup-btn" class="primary-btn">Finish Setup</button>
      </div>
    </div>
  </div>

  <!-- Main App Container -->
  <div id="root" class="app-container hidden">
    <header class="app-header">
      <div class="header-content">
        <div class="user-info">
          <span id="user-role-badge" class="role-badge">Student</span>
          <span class="greeting">Hello, <span id="user-display-name">---</span></span>
          <h2 class="app-title">DTR Dashboard</h2>
        </div>
        <div class="header-actions">
          <button type="button" id="theme-toggle" class="icon-btn">
            <i data-lucide="moon"></i>
          </button>
          <button type="button" id="logout-btn" class="icon-btn danger">
            <i data-lucide="log-out"></i>
          </button>
          <button type="button" id="settings-btn" class="icon-btn">
            <i data-lucide="settings"></i>
          </button>
        </div>
      </div>
    </header>

    <!-- Teacher Dashboard -->
    <section id="teacher-section" class="teacher-panel hidden">
      <div class="panel-header">
        <div class="header-titles">
          <h3>Class Management</h3>
          <p id="student-count" class="student-count">0 students joined</p>
        </div>

        <div id="class-selector" class="class-selector-container">
          <!-- Class pills injected here -->
          <button type="button" id="add-class-btn" class="class-pill add-class-btn">+ New Class</button>
        </div>

        <div class="class-code-card">
          <div class="code-info">
            <small>Current Class Code</small>
            <span id="display-class-code">---</span>
          </div>
          <button type="button" id="copy-code-btn" class="copy-btn">
            <i data-lucide="copy"></i>
            <span>Copy Code</span>
          </button>
        </div>
      </div>

      <!-- Teacher Analytics Overview -->
      <section id="teacher-analytics" class="analytics-grid">
        <div class="analytic-card">
          <span class="analytic-label">Class Avg</span>
          <span id="class-avg" class="analytic-value">0h</span>
        </div>
        <div class="analytic-card">
          <span class="analytic-label">Top Completion</span>
          <span id="top-pct" class="analytic-value">0%</span>
        </div>
      </section>

      <!-- Honor Roll Section -->
      <section id="honor-roll-section" class="honor-roll-card hidden">
        <div class="section-header">
          <h3><i data-lucide="trophy"
              style="width:18px;height:18px;color:#fbbf24;margin-right:8px;vertical-align:text-bottom;"></i>Honor Roll
          </h3>
        </div>
        <div id="honor-roll-list" class="honor-roll-list">
          <!-- Top 3 students injected here -->
        </div>
      </section>

      <div class="teacher-actions">
        <div class="search-box">
          <i data-lucide="search"></i>
          <input type="text" id="student-search" placeholder="Search students...">
        </div>
        <div class="utility-btns">
          <button type="button" id="refresh-teacher-btn" class="icon-btn-glass" title="Refresh">
            <i data-lucide="refresh-cw"></i>
          </button>
          <button type="button" id="export-class-btn" class="icon-btn-glass" title="Export Class Report">
            <i data-lucide="file-spreadsheet"></i>
          </button>
        </div>
      </div>

      <div id="students-list" class="students-list">
        <div class="empty-state">No students joined yet.</div>
      </div>
    </section>

    <!-- Student Dashboard -->
    <section id="student-section" class="student-panel hidden">
      <!-- Student Analytics -->
      <section id="student-analytics" class="analytics-grid">
        <div class="analytic-card">
          <span class="analytic-label">Avg Session</span>
          <span id="avg-session" class="analytic-value">0h</span>
          <span class="analytic-trend"><i data-lucide="trending-up" style="width:12px;height:12px;"></i> +12%</span>
        </div>
        <div class="analytic-card">
          <span class="analytic-label">7-Day Total</span>
          <span id="week-total" class="analytic-value">0h</span>
          <span class="analytic-trend"><i data-lucide="calendar" style="width:12px;height:12px;"></i> Last 7d</span>
        </div>
      </section>

      <!-- Stats Card -->
      <section class="stats-card">
        <div class="progress-circle-container">
          <svg class="progress-circle" viewBox="0 0 100 100">
            <circle class="bg" cx="50" cy="50" r="45"></circle>
            <circle id="progress-bar" class="progress" cx="50" cy="50" r="45"></circle>
          </svg>
          <div class="circle-content">
            <span id="rendered-hours">0h</span>
            <span id="rendered-percent" class="stat-percent">0%</span>
            <small>Done</small>
          </div>
        </div>
        <div class="stats-info">
          <div class="stat-item">
            <span class="stat-label">Goal Hours</span>
            <span id="goal-hours-display" class="stat-value">600h</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Remaining</span>
            <span id="remaining-hours" class="stat-value">600h</span>
          </div>
        </div>
      </section>

      <!-- Quick Actions -->
      <section class="quick-actions">
        <button type="button" id="time-in-btn" class="action-btn in">
          <i data-lucide="play"></i>
          <span>Time In</span>
        </button>
        <button type="button" id="time-out-btn" class="action-btn out disabled" disabled>
          <i data-lucide="square"></i>
          <span>Time Out</span>
        </button>
        <button type="button" id="manual-entry-btn" class="action-btn manual" title="Add Past Hours">
          <i data-lucide="edit-3"></i>
          <span>Add Past</span>
        </button>
        <button type="button" id="pause-btn" class="action-btn pause hidden">
          <i data-lucide="pause"></i>
          <span>Pause</span>
        </button>
      </section>

      <!-- Active Session -->
      <section id="active-session-card" class="active-session hidden">
        <div class="session-info">
          <span class="session-label">Session Active</span>
          <span id="session-timer" class="session-time">00:00:00</span>
        </div>
      </section>

      <!-- Recent Logs -->
      <section class="logs-section">
        <div class="section-header">
          <h3>Recent Logs</h3>
          <div class="header-btns">
            <button type="button" id="download-journal-btn" class="icon-btn-text" title="Download Journal">
              <i data-lucide="file-spreadsheet"></i>
              <span>Journal</span>
            </button>
            <button type="button" id="view-all-btn" class="text-btn">View All</button>
          </div>
        </div>
        <div id="logs-list" class="logs-list">
          <div class="empty-state">No sessions recorded yet.</div>
        </div>
      </section>
    </section>
  </div>



  <!-- History Modal -->
  <div id="history-modal" class="modal hidden">
    <div class="modal-content wide">
      <header class="modal-header">
        <h2>Full History</h2>
        <button type="button" id="close-history" class="icon-btn">
          <i data-lucide="x"></i>
        </button>
      </header>
      <div class="modal-body">
        <div id="history-logs-list" class="logs-list"></div>
      </div>
    </div>
  </div>

  <!-- Time Out Modal -->
  <div id="timeout-modal" class="modal hidden">
    <div class="modal-content">
      <header class="modal-header">
        <h2>Finish Session</h2>
        <button type="button" id="close-timeout" class="icon-btn">
          <i data-lucide="x"></i>
        </button>
      </header>
      <div class="modal-body">
        <p class="modal-description">Great job! What did you accomplish in this session?</p>
        <div class="form-group" style="margin-top: 1rem;">
          <label for="log-notes-input">Session Notes (Optional)</label>
          <textarea id="log-notes-input" placeholder="e.g. Worked on the admin dashboard, fixed bug in login..."
            rows="4"></textarea>
        </div>
        <button type="button" id="confirm-timeout-btn" class="primary-btn">
          <i data-lucide="check"></i>
          Confirm Time Out
        </button>
      </div>
    </div>
  </div>
  <!-- Manual Entry Modal -->
  <div id="manual-modal" class="modal hidden">
    <div class="modal-content">
      <header class="modal-header">
        <h2>Add Past Hours</h2>
        <button type="button" id="close-manual" class="icon-btn">
          <i data-lucide="x"></i>
        </button>
      </header>
      <div class="modal-body">
        <p class="modal-description">Enter the details of your previous OJT session.</p>
        <div class="form-grid">
          <div class="form-group">
            <label for="manual-date">Date</label>
            <input type="date" id="manual-date" required>
          </div>
          <div class="form-group">
            <label for="manual-time-in">Time In</label>
            <input type="time" id="manual-time-in" required>
          </div>
          <div class="form-group">
            <label for="manual-time-out">Time Out</label>
            <input type="time" id="manual-time-out" required>
          </div>
        </div>
        <div class="form-group">
          <label for="manual-notes">Activities Conducted</label>
          <textarea id="manual-notes" placeholder="e.g. Encoded documents, filed folders..." rows="3"></textarea>
        </div>
        <button type="button" id="save-manual-btn" class="primary-btn">
          <i data-lucide="check"></i>
          Add to Journal
        </button>
      </div>
    </div>
  </div>

  <!-- Modals -->
  <div id="settings-modal" class="modal hidden">
    <div class="modal-content">
      <header class="modal-header">
        <h2>Settings</h2>
        <button type="button" id="close-settings" class="icon-btn">
          <i data-lucide="x"></i>
        </button>
      </header>
      <div class="modal-body">
        <div class="form-group">
          <label for="goal-hours-input">Total OJT Goal Hours</label>
          <input type="number" id="goal-hours-input" value="600" placeholder="e.g. 600">
        </div>
        <button type="button" id="save-settings" class="primary-btn">Save Changes</button>

        <!-- Student Class Management -->
        <div id="student-class-settings" class="hidden">
          <hr />
          <div class="form-group">
            <label>My Class</label>
            <div id="no-class-view" class="class-join-box">
              <input type="text" id="join-class-input" placeholder="Enter Class Code">
              <button type="button" id="join-class-btn" class="primary-btn-mini">Join</button>
            </div>
            <div id="has-class-view" class="class-status-box hidden">
              <span class="status-text">Joined: <strong id="current-class-display">---</strong></span>
              <button type="button" id="leave-class-btn" class="secondary-btn-mini">
                <i data-lucide="log-out"></i>
                <span>Leave</span>
              </button>
            </div>
          </div>
        </div>

        <hr />

        <button type="button" id="export-db" class="secondary-btn">
          <i data-lucide="download"></i>
          Export SQLite DB
        </button>
        <button type="button" id="clear-data" class="danger-btn">
          <i data-lucide="trash-2"></i>
          Clear All Data
        </button>
      </div>
    </div>
  </div>

  <!-- Student Detail Modal (For Teachers) -->
  <div id="student-modal" class="modal hidden">
    <div class="modal-content wide">
      <header class="modal-header">
        <h2 id="modal-student-name">Student Logs</h2>
        <button type="button" id="close-student-modal" class="icon-btn">
          <i data-lucide="x"></i>
        </button>
      </header>
      <div class="modal-body">
        <div class="student-stats-summary">
          <div class="stat-mini">
            <small>Rendered</small>
            <span id="modal-student-rendered">0h</span>
          </div>
          <div class="stat-mini">
            <small>Goal</small>
            <span id="modal-student-goal">600h</span>
          </div>
        </div>
        <div id="modal-student-logs" class="logs-list"></div>
      </div>
      <footer class="modal-footer">
        <button type="button" id="kick-student-btn" class="danger-btn">
          <i data-lucide="user-minus"></i>
          <span>Kick Student</span>
        </button>
      </footer>
    </div>
  </div>

  <!-- Create Class Modal -->
  <div id="create-class-modal" class="modal hidden">
    <div class="modal-content">
      <header class="modal-header">
        <h2>Create New Class</h2>
        <button type="button" id="close-create-class" class="icon-btn"><i data-lucide="x"></i></button>
      </header>
      <div class="modal-body">
        <div class="form-group">
          <label>Class Name</label>
          <input type="text" id="new-class-name" placeholder="e.g. BSCS 4-B">
        </div>
        <button type="button" id="confirm-create-class" class="primary-btn">Create Class</button>
      </div>
    </div>
  </div>

  <!-- Generic Confirmation Modal -->
  <div id="confirm-modal" class="modal hidden">
    <div class="modal-content">
      <header class="modal-header">
        <h2 id="confirm-title">Confirm Action</h2>
      </header>
      <div class="modal-body">
        <p id="confirm-description" class="modal-description">Are you sure you want to proceed?</p>
        <div class="modal-actions">
          <button type="button" id="confirm-cancel-btn" class="secondary-btn">Cancel</button>
          <button type="button" id="confirm-action-btn" class="primary-btn danger">Confirm</button>
        </div>
      </div>
    </div>
  </div>

  <div id="toast-container" class="toast-container"></div>

  <div class="version-tag">v8.1.1 (Pahibalo Update)</div>

  <script type="module" src="src/main.js"></script>
</body>

</html>